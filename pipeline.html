
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Pipeline &#8212; VAMPIRES DPP</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=4fea3ae4a0a4ba949df0a89bbae557cc2ce861ae" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorials" href="tutorials/index.html" />
    <link rel="prev" title="Quick-start guide" href="quickstart.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/scexao_logo.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">VAMPIRES DPP</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quickstart.html">
   Quick-start guide
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Pipeline
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="tutorials/index.html">
   Tutorials
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="tutorials/image_registration.html">
     Image Registration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tutorials/frame_selection.html">
     Frame Selection
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="api/index.html">
   API/Reference
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="api/organization.html">
     Organization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/calibration.html">
     Calibration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/frame_selection.html">
     Frame Selection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/image_registration.html">
     Image Registration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/image_processing.html">
     Image Processing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/utility.html">
     Utility
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/polarization.html">
     Polarization
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right"><a href="https://github.com/scexao-org/vampires_dpp"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/pipeline.md.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#processing-steps">
   Processing steps
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#configuration">
   Configuration
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#general-options">
     General Options
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#coronagraph-options">
     Coronagraph Options
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calibration-options">
     Calibration Options
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#frame-selection-options">
     Frame Selection Options
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#image-registration-options">
     Image Registration Options
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#collapsing-options">
     Collapsing Options
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#polarimetry-options">
     Polarimetry Options
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#templates">
   Templates
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#polarimetric-differential-imaging-pdi">
     Polarimetric Differential Imaging (PDI)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#single-cam">
     Single-cam
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spectral-differential-imaging-sdi">
     Spectral Differential Imaging (SDI)
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Pipeline</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#processing-steps">
   Processing steps
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#configuration">
   Configuration
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#general-options">
     General Options
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#coronagraph-options">
     Coronagraph Options
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calibration-options">
     Calibration Options
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#frame-selection-options">
     Frame Selection Options
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#image-registration-options">
     Image Registration Options
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#collapsing-options">
     Collapsing Options
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#polarimetry-options">
     Polarimetry Options
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#templates">
   Templates
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#polarimetric-differential-imaging-pdi">
     Polarimetric Differential Imaging (PDI)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#single-cam">
     Single-cam
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spectral-differential-imaging-sdi">
     Spectral Differential Imaging (SDI)
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="pipeline">
<h1>Pipeline<a class="headerlink" href="#pipeline" title="Permalink to this headline">#</a></h1>
<p>The VAMPIRES data processing pipeline uses a configuration file to automate the bulk reduction of VAMPIRES data. To run the pipeline, use the <code class="docutils literal notranslate"><span class="pre">dpp</span> <span class="pre">run</span></code> script</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">dpp</span> <span class="n">run</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">j</span> <span class="n">NUM_PROC</span><span class="p">]</span> <span class="n">config</span> <span class="p">[</span><span class="n">filenames</span> <span class="o">...</span><span class="p">]</span>

<span class="n">positional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="n">config</span>                <span class="n">path</span> <span class="n">to</span> <span class="n">configuration</span> <span class="n">file</span>
  <span class="n">filenames</span>             <span class="n">FITS</span> <span class="n">files</span> <span class="n">to</span> <span class="n">run</span> <span class="n">through</span> <span class="n">pipeline</span>

<span class="n">options</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>            <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
  <span class="o">-</span><span class="n">j</span> <span class="n">NUM_PROC</span><span class="p">,</span> <span class="o">--</span><span class="n">num</span><span class="o">-</span><span class="n">proc</span> <span class="n">NUM_PROC</span>
                        <span class="n">number</span> <span class="n">of</span> <span class="n">processors</span> <span class="n">to</span> <span class="n">use</span> <span class="k">for</span> <span class="n">multiprocessing</span>
                        <span class="p">(</span><span class="n">default</span> <span class="ow">is</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>or create a <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code> object and call the <code class="docutils literal notranslate"><span class="pre">run</span></code> method.</p>
<section id="processing-steps">
<h2>Processing steps<a class="headerlink" href="#processing-steps" title="Permalink to this headline">#</a></h2>
<p>The pipeline will reduce the data in the following order</p>
<ol class="simple">
<li><p>Calibration</p></li>
<li><p>Frame Selection</p></li>
<li><p>Image Registration</p></li>
<li><p>Collapsing</p></li>
<li><p>Polarimetric differential imaging</p></li>
</ol>
<div class="warning admonition">
<p class="admonition-title">Warning: Large data volume</p>
<p>The data volumes associated with typical VAMPIRES observations can easily balloon into the terabyte (TB) range when using this pipeline. It is strongly recommended to work with a large attached storage.</p>
<p>As an example, a half-night of coronagraphic data can easily produce 200 GB of raw data. The calibration, frame selection, and image-registration steps will <em>each</em> make a copy, leading to a data volume three to four times larger (600 GB to 800 GB). After the individual frames are collapsed the data size reduces by about two orders of magnitude, making them negligible in comparison.</p>
<p>An easy way to reclaim storage space is to delete the intermediate data products after you have finalized a reduction. You can always rerun the pipeline later to reproduce the files.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Troubleshooting</p>
<p>If you run into problems, take a look at the debug file, which will be saved to the same directory as the input config file with <code class="docutils literal notranslate"><span class="pre">_debug.log</span></code> appended to the file name as well as in the output directory.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>vpp run config.toml VMPA*.fits
tail config_debug.log
</pre></div>
</div>
</div>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">#</a></h2>
<p>The configuration file uses the <a class="reference external" href="https://toml.io">TOML</a> format. There are many options that have defaults, sometimes even sensible ones. In general, if an entire section is missing, the operation will be excluded. Note that sections for the configuration (e.g., <code class="docutils literal notranslate"><span class="pre">[calibration]</span></code>, <code class="docutils literal notranslate"><span class="pre">[frame_selection]</span></code>) can be in any order, although keeping them in the same order as the pipeline execution may be clearer.</p>
<p>We use <a class="reference external" href="https://semver.org/">semantic versioning</a>, so there are certain guarantees about the backwards compatibility of the pipeline, which means you don’t have to have the exact same version of <code class="docutils literal notranslate"><span class="pre">vampires_dpp</span></code> as in the configuration- merely a version that is compatible.</p>
<section id="general-options">
<h3>General Options<a class="headerlink" href="#general-options" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="vampires_dpp.pipeline.pipeline.Pipeline">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vampires_dpp.pipeline.pipeline.</span></span><span class="sig-name descname"><span class="pre">Pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_centers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coronagraph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">satspots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calibrate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_select</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">register</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collapse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polarimetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">products</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'0.5.0'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vampires_dpp.pipeline.pipeline.Pipeline" title="Permalink to this definition">#</a></dt>
<dd><p>Data Processing Pipeline options</p>
<p>The processing configuration is all done through this class, which can easily be converted to and from TOML. The options will set the processing steps in the pipeline. An important paradigm in the processing pipeline is skipping unnecessary operations. That means if a file already exists, the pipeline will only reprocess it if the <cite>force</cite> flag is set, which will reprocess all files for that step (and subsequent steps), or if the input file or files are newer. You can try this out by deleting one calibrated file from a processed output and re-running the pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – filename-friendly name used for outputs from this pipeline. For example “20230101_ABAur”</p></li>
<li><p><strong>coordinate</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#vampires_dpp.pipeline.config.CoordinateOptions" title="vampires_dpp.pipeline.config.CoordinateOptions"><em>CoordinateOptions</em></a><em>]</em>) – </p></li>
<li><p><strong>frame_centers</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Optional</em><em>[</em><em>list</em><em>]</em><em>]</em><em>]</em>) – Estimates of the star position in pixels (x, y) for each camera provided as a dict with “cam1” and “cam2” keys. If not provided, will use the geometric frame center, by default None.</p></li>
<li><p><strong>coronagraph</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#vampires_dpp.pipeline.config.CoronagraphOptions" title="vampires_dpp.pipeline.config.CoronagraphOptions"><em>CoronagraphOptions</em></a><em>]</em>) – If provided, sets coronagraph-specific options and processing</p></li>
<li><p><strong>satspots</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#vampires_dpp.pipeline.config.SatspotOptions" title="vampires_dpp.pipeline.config.SatspotOptions"><em>SatspotOptions</em></a><em>]</em>) – If provided, sets satellite-spot specific options and enable satellite spot processing for frame selection and image registration</p></li>
<li><p><strong>calibrate</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#vampires_dpp.pipeline.config.CalibrateOptions" title="vampires_dpp.pipeline.config.CalibrateOptions"><em>CalibrateOptions</em></a><em>]</em>) – If set, provides options for basic image calibration</p></li>
<li><p><strong>frame_select</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#vampires_dpp.pipeline.config.FrameSelectOptions" title="vampires_dpp.pipeline.config.FrameSelectOptions"><em>FrameSelectOptions</em></a><em>]</em>) – If set, provides options for frame selection</p></li>
<li><p><strong>register</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#vampires_dpp.pipeline.config.RegisterOptions" title="vampires_dpp.pipeline.config.RegisterOptions"><em>RegisterOptions</em></a><em>]</em>) – If set, provides options for image registration</p></li>
<li><p><strong>collapse</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#vampires_dpp.pipeline.config.CollapseOptions" title="vampires_dpp.pipeline.config.CollapseOptions"><em>CollapseOptions</em></a><em>]</em>) – If set, provides options for collapsing image cubes</p></li>
<li><p><strong>polarimetry</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#vampires_dpp.pipeline.config.PolarimetryOptions" title="vampires_dpp.pipeline.config.PolarimetryOptions"><em>PolarimetryOptions</em></a><em>]</em>) – If set, provides options for polarimetric differential imaging (PDI)</p></li>
<li><p><strong>products</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#vampires_dpp.pipeline.config.ProductOptions" title="vampires_dpp.pipeline.config.ProductOptions"><em>ProductOptions</em></a><em>]</em>) – If set, provides options for saving metadata, ADI, and PDI outputs.</p></li>
<li><p><strong>version</strong> (<em>str</em>) – The version of vampires_dpp that this configuration file is valid with. Typically not set by user.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><strong>Frame Centers</strong></p>
<p>Frame centers need to be given as a dictionary of x, y pairs, like</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">frame_centers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;cam1&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">127.5</span><span class="p">,</span> <span class="mf">127.5</span><span class="p">),</span>
    <span class="s2">&quot;cam2&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">127.5</span><span class="p">,</span> <span class="mf">127.5</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>It is important to note that these frame centers are in the <em>raw</em> frames. If you open up the frames in DS9 and set the cross on the image center, you can copy the x, y coordinates directly into the configuration. We recommend doing this, especially for coronagraphic data since the satellite spot cutout indices depend on the frame centers and any off-center data may not register appropriately.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span> <span class="o">=</span> <span class="n">PipelineOptions</span><span class="p">(</span>
<span class="go">        name=&quot;test_config&quot;,</span>
<span class="go">        coronagraph=dict(iwa=55),</span>
<span class="go">        satspots=dict(radius=11.2),</span>
<span class="go">        calibrate=dict(output_directory=&quot;calibrated&quot;),</span>
<span class="go">        collapse=dict(output_directory=&quot;collapsed&quot;),</span>
<span class="go">        polarimetry=dict(output_directory=&quot;pdi&quot;),</span>
<span class="go">    )</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">conf</span><span class="o">.</span><span class="n">to_toml</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;test_config&quot;</span>
<span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0.4.0&quot;</span>

<span class="k">[coronagraph]</span>
<span class="n">iwa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">55</span>

<span class="k">[satspots]</span>
<span class="n">radius</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">11.2</span>
<span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">84.6</span>
<span class="n">amp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">50</span>

<span class="k">[calibrate]</span>
<span class="n">output_directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;calibrated&quot;</span>

<span class="k">[calibrate.master_darks]</span>

<span class="k">[calibrate.master_flats]</span>

<span class="k">[collapse]</span>
<span class="n">output_directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;collapsed&quot;</span>

<span class="k">[polarimetry]</span>
<span class="n">output_directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;pdi&quot;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="vampires_dpp.pipeline.pipeline.Pipeline.from_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vampires_dpp.pipeline.pipeline.Pipeline.from_file" title="Permalink to this definition">#</a></dt>
<dd><p>Load configuration from TOML file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>PathLike</em>) – Path to TOML file with configuration settings.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the configuration <cite>version</cite> is not compatible with the current <cite>vampires_dpp</cite> version.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Pipeline</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;config.toml&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vampires_dpp.pipeline.pipeline.Pipeline.from_str">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">toml_str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vampires_dpp.pipeline.pipeline.Pipeline.from_str" title="Permalink to this definition">#</a></dt>
<dd><p>Load configuration from TOML string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>toml_str</strong> (<em>str</em>) – String of TOML configuration settings.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the configuration <cite>version</cite> is not compatible with the current <cite>vampires_dpp</cite> version.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vampires_dpp.pipeline.pipeline.Pipeline.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filenames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_proc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vampires_dpp.pipeline.pipeline.Pipeline.run" title="Permalink to this definition">#</a></dt>
<dd><p>Run the pipeline</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filenames</strong> (<em>Iterable</em><em>[</em><em>PathLike</em><em>]</em>) – Input filenames to process</p></li>
<li><p><strong>num_proc</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Number of processes to use for multi-processing, by default None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vampires_dpp.pipeline.pipeline.Pipeline.to_file">
<span class="sig-name descname"><span class="pre">to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vampires_dpp.pipeline.pipeline.Pipeline.to_file" title="Permalink to this definition">#</a></dt>
<dd><p>Save configuration settings to TOML file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>PathLike</em>) – Output filename</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vampires_dpp.pipeline.config.CoordinateOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vampires_dpp.pipeline.config.</span></span><span class="sig-name descname"><span class="pre">CoordinateOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pm_ra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pm_dec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'icrs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obstime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'J2016'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vampires_dpp.pipeline.config.CoordinateOptions" title="Permalink to this definition">#</a></dt>
<dd><p>Astronomical coordinate options</p>
<div class="tip admonition">
<p class="admonition-title">Tip: GAIA</p>
<p>This can be auto-generated wtih GAIA coordinate information through the command line <code class="docutils literal notranslate"><span class="pre">dpp</span> <span class="pre">new</span></code> interface.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>object</strong> (<em>str</em>) – SIMBAD-friendly object name</p></li>
<li><p><strong>ra</strong> (<em>str</em>) – Right ascension in sexagesimal hour angles</p></li>
<li><p><strong>dec</strong> (<em>str</em>) – Declination in sexagesimal degrees</p></li>
<li><p><strong>parallax</strong> (<em>float</em>) – parallax of system in mas</p></li>
<li><p><strong>pm_ra</strong> (<em>float</em>) – Proper motion of RA axis in mas/yr, by default 0.</p></li>
<li><p><strong>pm_dec</strong> (<em>float</em>) – Proper motion of DEC axis in mas/yr, by default 0.</p></li>
<li><p><strong>frame</strong> (<em>str</em>) – Coordinate reference frame, by default “icrs”.</p></li>
<li><p><strong>obstime</strong> (<em>str</em>) – Observation time as a string, by default “J2016” (to coincide with GAIA coordinates)</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vampires_dpp.pipeline.config.ProductOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vampires_dpp.pipeline.config.</span></span><span class="sig-name descname"><span class="pre">ProductOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adi_cubes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdi_cubes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vampires_dpp.pipeline.config.ProductOptions" title="Permalink to this definition">#</a></dt>
<dd><p>The output products from the processing pipeline.</p>
<div class="admonition-outputs admonition">
<p class="admonition-title">Outputs</p>
<p><strong>Header Table:</strong></p>
<p>A table with the header information of all the input files will be saved to a CSV in the output directory.</p>
<p><strong>ADI Outputs:</strong></p>
<p>The ADI outputs will include a cube for each camera and the corresponding derotation angles. For ADI analysis, you can either interleave the two cubes into one cube with double the frames, add the two camera frames before post-processing, or add the two ADI residuals from each camera after post-processing.</p>
<p><strong>PDI Outputs:</strong></p>
<p>If <cite>polarimetry</cite> is set, PDI outputs will be constructed from the triple-differential method. This includes a cube with various Stokes quantities from each HWP cycle, and a derotated and collapsed cube of Stokes quantities. The Stokes quantities are listed in the “STOKES” header, and are</p>
<ol class="arabic simple">
<li><p>Stokes I</p></li>
<li><p>Stokes Q</p></li>
<li><p>Stokes U</p></li>
<li><p>Radial Stokes Qphi</p></li>
<li><p>Radial Stokse Uphi</p></li>
<li><p>Linear polarized intensity</p></li>
<li><p>Angle of linear polarization</p></li>
</ol>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>header_table</strong> (<em>bool</em>) – If true, saves a CSV with header information, by default true.</p></li>
<li><p><strong>adi_cubes</strong> (<em>bool</em>) – If true, saves ADI outputs</p></li>
<li><p><strong>pdi_cubes</strong> (<em>bool</em>) – If true, saves PDI triple-diff cubes</p></li>
<li><p><strong>output_directory</strong> (<em>Optional</em><em>[</em><em>Path</em><em>]</em>) – The products will be saved to the output directory. If not provided, will use the current working directory. By default None.</p></li>
<li><p><strong>force</strong> (<em>bool</em>) – If true, will force all products to be recreated step to occur.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span> <span class="o">=</span> <span class="n">ProductOptions</span><span class="p">(</span><span class="n">output_directory</span><span class="o">=</span><span class="s2">&quot;products&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">conf</span><span class="o">.</span><span class="n">to_toml</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[products]</span>
<span class="n">output_directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;products&quot;</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="coronagraph-options">
<h3>Coronagraph Options<a class="headerlink" href="#coronagraph-options" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="vampires_dpp.pipeline.config.CoronagraphOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vampires_dpp.pipeline.config.</span></span><span class="sig-name descname"><span class="pre">CoronagraphOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iwa</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vampires_dpp.pipeline.config.CoronagraphOptions" title="Permalink to this definition">#</a></dt>
<dd><p>Coronagraph options</p>
<p>The IWAs for the masks are listed on the <a class="reference external" href="https://www.naoj.org/Projects/SCEXAO/scexaoWEB/030openuse.web/040vampires.web/100vampcoronagraph.web/indexm.html">VAMPIRES website</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>iwa</strong> (<em>float</em>) – Coronagraph inner working angle (IWA) in mas.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span> <span class="o">=</span> <span class="n">CoronagraphOptions</span><span class="p">(</span><span class="n">iwa</span><span class="o">=</span><span class="mi">55</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">conf</span><span class="o">.</span><span class="n">to_toml</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[coronagraph]</span>
<span class="n">iwa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">55</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vampires_dpp.pipeline.config.SatspotOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vampires_dpp.pipeline.config.</span></span><span class="sig-name descname"><span class="pre">SatspotOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">84.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vampires_dpp.pipeline.config.SatspotOptions" title="Permalink to this definition">#</a></dt>
<dd><p>Satellite spot options</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>float</em>) – Satellite spot radius in lambda/D, by default 15.9. If doing PDI with CHARIS this should be 11.2.</p></li>
<li><p><strong>angle</strong> (<em>float</em>) – Satellite spot position angle (in degrees), by default 45 - <cite>PUPIL_OFFSET</cite>.</p></li>
<li><p><strong>amp</strong> (<em>float</em>) – Satellite spot modulation amplitude (in nm), by default 50.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span> <span class="o">=</span> <span class="n">SatspotOptions</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">11.2</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">conf</span><span class="o">.</span><span class="n">to_toml</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[satspots]</span>
<span class="n">radius</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">11.2</span>
<span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">84.6</span>
<span class="n">amp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">25</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="calibration-options">
<h3>Calibration Options<a class="headerlink" href="#calibration-options" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="vampires_dpp.pipeline.config.CalibrateOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vampires_dpp.pipeline.config.</span></span><span class="sig-name descname"><span class="pre">CalibrateOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">master_darks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">CamFileInput(cam1=None,</span> <span class="pre">cam2=None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">master_flats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">CamFileInput(cam1=None,</span> <span class="pre">cam2=None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distortion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_bad_pixels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deinterleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vampires_dpp.pipeline.config.CalibrateOptions" title="Permalink to this definition">#</a></dt>
<dd><p>Options for general image calibration</p>
<p>The calibration strategy is generally</p>
<ol class="arabic simple">
<li><p>Subtract dark frame, if provided</p></li>
<li><p>Normalize by flat field, if provided</p></li>
<li><p>Bad pixel correction, if set</p></li>
<li><p>Flip camera 1 data along y-axis</p></li>
<li><p>Apply distortion correction, if provided</p></li>
<li><p>Deinterleave FLC states, if set</p></li>
</ol>
<div class="warning admonition">
<p class="admonition-title">Deinterleaving</p>
<p>Deinterleaving should not be required for data downloaded from STARS. Only set this option if you are dealing with PDI data downloaded directly from the VAMPIRES computer.</p>
</div>
<div class="admonition-outputs admonition">
<p class="admonition-title">Outputs</p>
<p>If <cite>deinterleave</cite> is set, two files will be saved in the output directory for each input file, with <cite>_FLC1</cite> and <cite>_FLC2</cite> appended. The calibrated files will be saved with the “_calib” suffix.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>master_darks</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Optional</em><em>[</em><em>Path</em><em>]</em><em>]</em><em>]</em>) – If provided, must be a dict with keys for “cam1” and “cam2” master darks. You can omit one of the cameras. By default None.</p></li>
<li><p><strong>master_flats</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Optional</em><em>[</em><em>Path</em><em>]</em><em>]</em><em>]</em>) – If provided, must be a dict with keys for “cam1” and “cam2” master flats. You can omit one of the cameras. By default None.</p></li>
<li><p><strong>distortion</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#vampires_dpp.pipeline.config.DistortionOptions" title="vampires_dpp.pipeline.config.DistortionOptions"><em>DistortionOptions</em></a><em>]</em>) – (Advanced) Options for geometric distortion correction. By default None.</p></li>
<li><p><strong>fix_bad_pixels</strong> (<em>bool</em>) – If true, will run LACosmic algorithm for one iteration on each frame and correct bad pixels. By default false.</p></li>
<li><p><strong>deinterleave</strong> (<em>bool</em>) – <strong>(Advanced)</strong> If true, will deinterleave every other file into the two FLC states. By default false.</p></li>
<li><p><strong>output_directory</strong> (<em>Optional</em><em>[</em><em>Path</em><em>]</em>) – The calibrated files will be saved to the output directory. If not provided, will use the current working directory. By default None.</p></li>
<li><p><strong>force</strong> (<em>bool</em>) – If true, will force this processing step to occur.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">master_darks</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cam1&quot;</span><span class="p">:</span> <span class="s2">&quot;master_dark_cam1.fits&quot;</span><span class="p">,</span> <span class="s2">&quot;cam2&quot;</span><span class="p">:</span> <span class="s2">&quot;master_dark_cam2.fits&quot;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;transform_filename&quot;</span><span class="p">:</span> <span class="s2">&quot;20230102_fcs16000_params.csv&quot;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span> <span class="o">=</span> <span class="n">CalibrateOptions</span><span class="p">(</span>
<span class="go">        master_darks=master_darks,</span>
<span class="go">        distortion=dist,</span>
<span class="go">        output_directory=&quot;calibrated&quot;</span>
<span class="go">    )</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">conf</span><span class="o">.</span><span class="n">to_toml</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[calibrate]</span>
<span class="n">output_directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;calibrated&quot;</span>

<span class="k">[calibrate.master_darks]</span>
<span class="n">cam1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;master_dark_cam1.fits&quot;</span>
<span class="n">cam2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;master_dark_cam2.fits&quot;</span>

<span class="k">[calibrate.master_flats]</span>

<span class="k">[calibrate.distortion]</span>
<span class="n">transform_filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;20230102_fcs16000_params.csv&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vampires_dpp.pipeline.config.DistortionOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vampires_dpp.pipeline.config.</span></span><span class="sig-name descname"><span class="pre">DistortionOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transform_filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vampires_dpp.pipeline.config.DistortionOptions" title="Permalink to this definition">#</a></dt>
<dd><p>Geometric distortion correction options</p>
<div class="warning admonition">
<p class="admonition-title">Advanced Usage</p>
<p>Distortion correction requires specialized calibration files. Please get in contact with the SCExAO team for more details</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>transform_filename</strong> (<em>Path</em>) – The path to a CSV with the distortion corrections for each camera.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="frame-selection-options">
<h3>Frame Selection Options<a class="headerlink" href="#frame-selection-options" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="vampires_dpp.pipeline.config.FrameSelectOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vampires_dpp.pipeline.config.</span></span><span class="sig-name descname"><span class="pre">FrameSelectOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normvar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vampires_dpp.pipeline.config.FrameSelectOptions" title="Permalink to this definition">#</a></dt>
<dd><p>Frame selection options</p>
<p>Frame selection metrics can be measured on the central PSF, or can be done on calibration speckles (satellite spots). Satellite spots will be used if the <cite>satspots</cite> option is set in the pipeline. The quality metrics are</p>
<ul class="simple">
<li><p>normvar - The variance normalized by the mean.</p></li>
<li><p>l2norm - The L2-norm, roughly equivalent to the RMS value</p></li>
<li><p>peak - maximum value</p></li>
</ul>
<div class="admonition-outputs admonition">
<p class="admonition-title">Outputs</p>
<p>For each input file, a CSV with frame selection metrics for each slice will be saved in the output directory with the “_metrics” suffix and a cube with bad frames discarded will be saved with the “_selected” suffix.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff</strong> (<em>float</em>) – The cutoff quantile for frame selection where 0 means no frame selection and 1 would discard all frames.</p></li>
<li><p><strong>metric</strong> (<em>str</em>) – The frame selection metric, one of <cite>“peak”</cite>, <cite>“l2norm”</cite>, and <cite>“normvar”</cite>, by default <cite>“normvar”</cite>.</p></li>
<li><p><strong>window_size</strong> (<em>int</em>) – The window size (in pixels) to cut out around PSFs before measuring the frame selection metric, by default 30.</p></li>
<li><p><strong>output_directory</strong> (<em>Optional</em><em>[</em><em>Path</em><em>]</em>) – The trimmed files will be saved to the output directory. If not provided, will use the current working directory. By default None.</p></li>
<li><p><strong>force</strong> (<em>bool</em>) – If true, will force this processing step to occur.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span> <span class="o">=</span> <span class="n">FrameSelectOptions</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">output_directory</span><span class="o">=</span><span class="s2">&quot;selected&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">conf</span><span class="o">.</span><span class="n">to_toml</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[frame_select]</span>
<span class="n">output_directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;selected&quot;</span>
<span class="n">cutoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.7</span>
<span class="n">metric</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;normvar&quot;</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="image-registration-options">
<h3>Image Registration Options<a class="headerlink" href="#image-registration-options" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="vampires_dpp.pipeline.config.RegisterOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vampires_dpp.pipeline.config.</span></span><span class="sig-name descname"><span class="pre">RegisterOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'com'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dft_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vampires_dpp.pipeline.config.RegisterOptions" title="Permalink to this definition">#</a></dt>
<dd><p>Image registration options</p>
<p>Image registration can be done on the central PSF, or can be done on calibration speckles (satellite spots). Satellite spots will be used if the <cite>satspots</cite> option is set in the pipeline. The registration methods are</p>
<ul class="simple">
<li><p>com - centroid</p></li>
<li><p>peak - pixel at highest value</p></li>
<li><p>dft - Cross-correlation between frames using discrete Fourier transform (DFT) upsampling for subpixel accuracy</p></li>
<li><p>gaussian - Model fit using a Gaussian PSF</p></li>
<li><p>airydisk - Model fit using a Moffat PSF</p></li>
<li><p>moffat - Model fit using an Airy disk PSF</p></li>
</ul>
<div class="admonition-outputs admonition">
<p class="admonition-title">Outputs</p>
<p>For each input file, a CSV with PSF centroids (or centroids for each satellite spot) will be saved in the output directory with the “_offsets” suffix and a registered cube will be saved with the “_aligned” suffix.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em>) – The image registration method, one of <cite>“com”</cite>, <cite>“peak”</cite>, <cite>“dft”</cite>, <cite>“airydisk”</cite>, <cite>“moffat”</cite>, or <cite>“gaussian”</cite>. By default <cite>“com”</cite>.</p></li>
<li><p><strong>window_size</strong> (<em>int</em>) – The window size (in pixels) to cut out around PSFs before measuring the centroid, by default 30.</p></li>
<li><p><strong>smooth</strong> (<em>bool</em>) – If true, will Gaussian smooth the input frames before measuring offsets, by default false.</p></li>
<li><p><strong>dft_factor</strong> (<em>int</em>) – If using the DFT method, the upsampling factor (inverse of centroid precision), by default 1.</p></li>
<li><p><strong>output_directory</strong> (<em>Optional</em><em>[</em><em>Path</em><em>]</em>) – The PSF offsets and aligned files will be saved to the output directory. If not provided, will use the current working directory. By default None.</p></li>
<li><p><strong>force</strong> (<em>bool</em>) – If true, will force this processing step to occur.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span> <span class="o">=</span> <span class="n">RegisterOptions</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;com&quot;</span><span class="p">,</span> <span class="n">output_directory</span><span class="o">=</span><span class="s2">&quot;registered&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">conf</span><span class="o">.</span><span class="n">to_toml</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[register]</span>
<span class="n">output_directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;registered&quot;</span>
<span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;com&quot;</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="collapsing-options">
<h3>Collapsing Options<a class="headerlink" href="#collapsing-options" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="vampires_dpp.pipeline.config.CollapseOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vampires_dpp.pipeline.config.</span></span><span class="sig-name descname"><span class="pre">CollapseOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'median'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vampires_dpp.pipeline.config.CollapseOptions" title="Permalink to this definition">#</a></dt>
<dd><p>Cube collapse options</p>
<ul class="simple">
<li><p>median - Pixel-by-pixel median</p></li>
<li><p>mean - Pixel-by-pixel mean</p></li>
<li><p>varmean - Pixel-by-pixel mean weighted by frame variance</p></li>
<li><p>biweight - Pixel-by-pixel biweight location</p></li>
</ul>
<div class="admonition-outputs admonition">
<p class="admonition-title">Outputs</p>
<p>For each input file, a collapsed frame will be saved in the output directory with the “_collapsed” suffix.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em>) – The collapse method, one of <cite>“median”</cite>, <cite>“mean”</cite>, <cite>“varmean”</cite>, or <cite>“biweight”</cite>. By default <cite>“median”</cite>.</p></li>
<li><p><strong>output_directory</strong> (<em>Optional</em><em>[</em><em>Path</em><em>]</em>) – The collapsed files will be saved to the output directory. If not provided, will use the current working directory. By default None.</p></li>
<li><p><strong>force</strong> (<em>bool</em>) – If true, will force this processing step to occur.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span> <span class="o">=</span> <span class="n">CollapseOptions</span><span class="p">(</span><span class="n">output_directory</span><span class="o">=</span><span class="s2">&quot;collapsed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">conf</span><span class="o">.</span><span class="n">to_toml</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[collapse]</span>
<span class="n">output_directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;collapsed&quot;</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="polarimetry-options">
<h3>Polarimetry Options<a class="headerlink" href="#polarimetry-options" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="vampires_dpp.pipeline.config.PolarimetryOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vampires_dpp.pipeline.config.</span></span><span class="sig-name descname"><span class="pre">PolarimetryOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_per_hwp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'QQUU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">derotate_pa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vampires_dpp.pipeline.config.PolarimetryOptions" title="Permalink to this definition">#</a></dt>
<dd><p>Polarimetric differential imaging (PDI) options</p>
<div class="warning admonition">
<p class="admonition-title">Warning: experimental</p>
<p>The polarimetric reduction in this pipeline is an active work-in-progress. Do not consider any outputs publication-ready without further vetting and consultation with the SCExAO team.</p>
</div>
<p>PDI is processed after all of the individual file processing since it requires sorting the files into complete sets for the triple-differential calibration.</p>
<div class="admonition-outputs admonition">
<p class="admonition-title">Outputs</p>
<p>Diff images will be saved in the output directory. If IP options are set, the IP corrected frames will also be saved.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ip</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#vampires_dpp.pipeline.config.IPOptions" title="vampires_dpp.pipeline.config.IPOptions"><em>IPOptions</em></a><em>]</em>) – Instrumental polarization (IP) correction options, by default None.</p></li>
<li><p><strong>N_per_hwp</strong> (<em>int</em>) – Number of cubes expected per HWP position, by default 1.</p></li>
<li><p><strong>order</strong> (<em>str</em>) – HWP iteration order, one of <cite>“QQUU”</cite> or <cite>“QUQU”</cite>. By default <cite>“QQUU”</cite>.</p></li>
<li><p><strong>derotate_pa</strong> (<em>bool</em>) – If true, will not assume the HWP is in pupil-tracking mode (the default) which requires additional rotation of the Stokes vectors by the parallactic angle. By defult, False.</p></li>
<li><p><strong>output_directory</strong> (<em>Optional</em><em>[</em><em>Path</em><em>]</em>) – The diff images will be saved to the output directory. If not provided, will use the current working directory. By default None.</p></li>
<li><p><strong>force</strong> (<em>bool</em>) – If true, will force this processing step to occur.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span> <span class="o">=</span> <span class="n">PolarimetryOptions</span><span class="p">(</span><span class="n">ip</span><span class="o">=</span><span class="n">IPOptions</span><span class="p">(),</span> <span class="n">output_directory</span><span class="o">=</span><span class="s2">&quot;pdi&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">conf</span><span class="o">.</span><span class="n">to_toml</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[polarimetry]</span>
<span class="n">output_directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;pdi&quot;</span>

<span class="k">[polarimetry.ip]</span>
<span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;photometry&quot;</span>
<span class="n">aper_rad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vampires_dpp.pipeline.config.IPOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vampires_dpp.pipeline.config.</span></span><span class="sig-name descname"><span class="pre">IPOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'photometry'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aper_rad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vampires_dpp.pipeline.config.IPOptions" title="Permalink to this definition">#</a></dt>
<dd><p>Instrumental polarization (IP) correction options.</p>
<p>There are three main IP correction techniques</p>
<ul class="simple">
<li><dl class="simple">
<dt>Ad-hoc correction using PSF photometry</dt><dd><p>In each diff image, the partial polarization of the central PSF is measured and removed, presuming there should be no polarized stellar signal. In coronagraphic data, this uses the light penetrating the partially transmissive focal plane masks (~0.06%).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Ad-hoc correction using PSF photometry of calibration speckles (satellite spots)</dt><dd><p>Same as above, but using the average correction for the four satellite spot PSFs instead of the central PSF.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Mueller-matrix model correction (not currently implemented)</dt><dd><p>Uses a calibrated Mueller-matrix model which accurately reflects the impacts of all polarizing optics in VAMPIRES. WIP.</p>
</dd>
</dl>
</li>
</ul>
<div class="admonition-outputs admonition">
<p class="admonition-title">Outputs</p>
<p>For each diff image a copy will be saved with the IP correction applied and the “_ip” file suffix attached.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em>) – IP correction method, one of <cite>“photometry”</cite>, <cite>“satspots”</cite>, or <cite>“mueller”</cite>. By default, <cite>“photometry”</cite></p></li>
<li><p><strong>aper_rad</strong> (<em>float</em>) – For photometric-based methods, the aperture radius in pixels. By default, 6.</p></li>
<li><p><strong>force</strong> (<em>bool</em>) – If true, will force this processing step to occur.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="templates">
<h2>Templates<a class="headerlink" href="#templates" title="Permalink to this headline">#</a></h2>
<section id="polarimetric-differential-imaging-pdi">
<h3>Polarimetric Differential Imaging (PDI)<a class="headerlink" href="#polarimetric-differential-imaging-pdi" title="Permalink to this headline">#</a></h3>
<details>
<summary>PDI example</summary>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0.5.0&quot;</span>

<span class="k">[frame_centers]</span>
<span class="n">cam1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="n">cam2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="k">[calibrate]</span>
<span class="n">output_directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;calibrated&quot;</span>

<span class="k">[calibrate.master_darks]</span>

<span class="k">[calibrate.master_flats]</span>

<span class="k">[register]</span>
<span class="n">output_directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;registered&quot;</span>
<span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;peak&quot;</span>

<span class="k">[collapse]</span>
<span class="n">output_directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;collapsed&quot;</span>

<span class="k">[polarimetry]</span>
<span class="n">output_directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;pdi&quot;</span>

<span class="k">[polarimetry.ip]</span>
<span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;photometry&quot;</span>
<span class="n">aper_rad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span>

<span class="k">[products]</span>
<span class="n">output_directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;products&quot;</span>
</pre></div>
</div>
</details>
</section>
<section id="single-cam">
<h3>Single-cam<a class="headerlink" href="#single-cam" title="Permalink to this headline">#</a></h3>
<p>For single-cam data you can elude all of the <code class="docutils literal notranslate"><span class="pre">cam2</span></code> keys in the configuration.</p>
<details>
<summary>Single-cam example</summary>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0.5.0&quot;</span>

<span class="k">[frame_centers]</span>
<span class="n">cam1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="k">[calibrate]</span>
<span class="n">output_directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;calibrated&quot;</span>

<span class="k">[calibrate.master_darks]</span>

<span class="k">[calibrate.master_flats]</span>

<span class="k">[register]</span>
<span class="n">output_directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;registered&quot;</span>
<span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;peak&quot;</span>

<span class="k">[collapse]</span>
<span class="n">output_directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;collapsed&quot;</span>

<span class="k">[products]</span>
<span class="n">output_directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;products&quot;</span>
</pre></div>
</div>
</details>
</section>
<section id="spectral-differential-imaging-sdi">
<h3>Spectral Differential Imaging (SDI)<a class="headerlink" href="#spectral-differential-imaging-sdi" title="Permalink to this headline">#</a></h3>
<div class="warning admonition">
<p class="admonition-title">Warning: WIP</p>
<p>The full functionality for SDI is not implemented, but the collapsed data can be used as inputs to manual reductions, for now.</p>
</div>
<p>SDI reduction looks a lot like PDI reduction without the polarimetry.</p>
<details>
<summary>H-alpha example</summary>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0.5.0&quot;</span>

<span class="k">[frame_centers]</span>
<span class="n">cam1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="n">cam2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="k">[calibrate]</span>
<span class="n">output_directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;calibrated&quot;</span>

<span class="k">[calibrate.master_darks]</span>

<span class="k">[calibrate.master_flats]</span>

<span class="k">[register]</span>
<span class="n">output_directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;registered&quot;</span>
<span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;peak&quot;</span>

<span class="k">[collapse]</span>
<span class="n">output_directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;collapsed&quot;</span>

<span class="k">[products]</span>
<span class="n">output_directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;products&quot;</span>
</pre></div>
</div>
</details>
</section>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="quickstart.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Quick-start guide</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="tutorials/index.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Tutorials</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Miles Lucas<br/>
  
      &copy; Copyright 2022, 2023, Miles Lucas.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>